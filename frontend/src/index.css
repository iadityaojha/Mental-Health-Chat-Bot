@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
    --bg: #F5F7FB;
    --glass: rgba(255, 255, 255, 0.7);
    --muted: #97A0B3;
    --accent-start: #B9F2E6;
    --accent-end: #C9BEFF;
    --primary: #5B6CFF;
    --shadow: 0 8px 30px rgba(11, 22, 40, 0.06);
    --card-radius: 18px;
    --smooth: cubic-bezier(.2, .9, .3, 1);
}

body {
    background: radial-gradient(1200px 600px at 10% 10%, rgba(201, 190, 255, 0.06), transparent 12%),
        radial-gradient(900px 500px at 90% 90%, rgba(185, 242, 230, 0.04), transparent 12%),
        var(--bg);
    color: #12202b;
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    height: 100vh;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}

#root {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

@layer components {
    .app-container {
        width: 96vw;
        /* Slightly smaller than full width */
        max-width: 1400px;
        height: 95vh;
        /* Slightly smaller than full height */
        min-height: 600px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.6), rgba(250, 250, 252, 0.7));
        border-radius: 24px;
        /* Restore rounded corners */
        box-shadow: var(--shadow);
        /* Restore shadow */
        display: grid;
        grid-template-columns: 88px 1fr;
        overflow: hidden;
        border: 1px solid rgba(19, 28, 45, 0.04);
    }

    .sidebar-glass {
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.6), rgba(250, 250, 252, 0.45));
        backdrop-filter: blur(8px);
        border-right: 1px solid rgba(19, 28, 45, 0.03);
    }

    .icon-btn {
        width: 52px;
        height: 52px;
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform .18s var(--smooth), box-shadow .18s var(--smooth);
        border: 1px solid rgba(11, 22, 40, 0.04);
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(6px);
    }

    .icon-btn:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 24px rgba(11, 22, 40, 0.06);
    }

    .glass-header {
        height: 72px;
        border-bottom: 1px solid rgba(19, 28, 45, 0.03);
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.4));
        backdrop-filter: blur(6px);
        flex-shrink: 0;
        /* Prevent shrinking */
    }

    .bot-bubble {
        background: var(--glass);
        border: 1px solid rgba(255, 255, 255, 0.55);
        border-radius: 16px;
    }

    .user-bubble {
        background: linear-gradient(90deg, var(--accent-start), var(--accent-end));
        color: #071126;
        border-radius: 20px;
    }

    .composer {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 999px;
        border: 1px solid rgba(11, 22, 40, 0.04);
        box-shadow: 0 10px 30px rgba(11, 22, 40, 0.03);
    }
}

@layer utilities {
    .typing-dot {
        animation: dotMove .9s infinite ease-in-out;
    }

    .typing-dot:nth-child(2) {
        animation-delay: .12s;
    }

    .typing-dot:nth-child(3) {
        animation-delay: .24s;
    }

    @keyframes dotMove {
        0% {
            transform: translateY(0);
            opacity: .5;
        }

        50% {
            transform: translateY(-6px);
            opacity: 1;
        }

        100% {
            transform: translateY(0);
            opacity: .5;
        }
    }

    .fade-in-up {
        animation: fadeInUp .36s var(--smooth) forwards;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(6px);
        }

        to {
            opacity: 1;
            transform: none;
        }
    }
}

@media (max-width: 980px) {
    .app-container {
        grid-template-columns: 72px 1fr;
        /* Removed width/height overrides as they are now 100vw/vh by default */
    }
}

@media (max-width: 720px) {
    body {
        padding: 0;
        /* Ensure no padding on mobile */
    }

    .app-container {
        grid-template-columns: 1fr;
        border-radius: 0;
    }

    .sidebar-glass {
        display: none;
    }

    .glass-header {
        height: 64px;
    }
}

/* ---------- Layout fixes for clipped text & overlapping sidebar ---------- */

/* Ensure sidebar has a stable width that won't overlap main content */
.app {
    /* slightly wider sidebar column so icons + badges fit */
    grid-template-columns: 100px 1fr !important;
    position: relative;
}

/* Sidebar visual tweaks */
.sidebar {
    width: 100%;
    /* keep column managed by grid but allow inner padding */
    padding: 18px 14px 18px 14px !important;
    /* leave more left/right padding */
    overflow: visible !important;
    /* allow popouts/tooltips to be visible */
    z-index: 2;
    /* keep sidebar above canvas edges but not over header brand */
}

/* Logo in sidebar — prevent overlapping header by constraining size and margin */
.sidebar .logo {
    width: 48px !important;
    height: 48px !important;
    border-radius: 12px !important;
    margin: 2px 0 6px 0 !important;
    flex-shrink: 0;
}

/* header should be inside the 'main' column; ensure left padding aligns with content */
.header {
    padding-left: 22px !important;
    /* aligns header content away from the left column */
    padding-right: 22px !important;
    z-index: 3;
    /* be above general canvas elements */
}

/* Brand block spacing to avoid overlap with sidebar */
.brand {
    display: flex;
    gap: 12px;
    align-items: center;
    margin-left: 0 !important;
    /* Ensure no negative/overlapping margins */
}

/* Chat canvas inner padding to keep content away from left edge */
.canvas {
    padding-left: 26px !important;
    padding-right: 26px !important;
    box-sizing: border-box;
}

/* Chat scroll area: leave bottom padding and avoid content touching edges */
.chat-wrap {
    padding: 8px 8px 56px 8px !important;
    /* bottom padding so composer doesn't cover last message */
    overflow-y: auto;
}

/* Message bubbles: wrap long words, avoid overflow and clipping */
.message,
.bot-bubble .content,
.user-bubble {
    word-break: break-word !important;
    white-space: pre-wrap !important;
    max-width: 78% !important;
    box-sizing: border-box;
}

/* Quick reply chips: allow wrapping and proper gap */
.quick-chips {
    display: flex;
    gap: 10px;
    flex-wrap: wrap !important;
    /* crucial: wrap chips to next line instead of growing horizontally */
    align-items: center;
    padding: 6px 0;
}

/* Chip style: allow multi-line labels (if designer or translation makes them long) */
.chip {
    white-space: normal !important;
    /* allow text wrap inside chip */
    max-width: calc(100% - 40px);
}

/* Small avatar badges (if present in top-left) — keep them inside sidebar, not overlapping header */
.brand .small-badge,
.top-badge {
    position: static !important;
    transform: none !important;
    margin-left: 0 !important;
}

/* Composer: make sure it sits inside canvas and not off-screen */
.composer-wrap {
    position: sticky;
    bottom: 0;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.9));
    z-index: 4;
}

/* Responsive tweak: reduce sidebar width on smaller screens but avoid overlay */
@media (max-width: 980px) {
    .app {
        grid-template-columns: 72px 1fr !important;
    }

    .sidebar .logo {
        width: 42px;
        height: 42px;
    }

    .header {
        padding-left: 14px;
        padding-right: 14px;
    }
}

/* Safety: ensure no element is unintentionally clipped by rounded corners */
.app>* {
    overflow: visible;
}

/* tiny visual fix: keep header text accessible */
.brand h1 {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 420px;
}

/* a11y: ensure focus outlines remain visible after overrides */
:focus {
    outline: 3px solid rgba(91, 108, 255, 0.18);
    outline-offset: 2px;
}